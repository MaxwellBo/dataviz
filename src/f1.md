# F1


```js
const positions = await FileAttachment("f1.json").json();

display(positions)
// Transform the data into a more reasonable structure
const tidy = Object.keys(positions.X).map(key => ({
  date: positions.Date[key],
  status: positions.Status[key],
  x: positions.X[key],
  y: positions.Y[key],
  source: positions.Source[key],
  time: positions.Time[key],
  DriverAhead: positions.DriverAhead[key],
  DistanceToDriverAhead: positions.DistanceToDriverAhead[key],
  sessionTime: positions.SessionTime[key]
}));
display(tidy)
Inputs.table(tidy)

```
Plot the positions
```js
Plot.plot({
  marks: [Plot.dot(tidy, {x: "x", y: "y"})]
})
```

Plot the driver ahead by time
```js
Plot.plot({
  marks: [Plot.line(tidy, {x: "sessionTime", y: "DistanceToDriverAhead"})]
})
```

Plot the driver ahead themselves by time
```js
Plot.plot({
  marks: [Plot.line(tidy, {x: "sessionTime", y: "DriverAhead"})]
})
```

Whenever the driver ahead changes, mark the change location on map

```js
const changes = tidy.filter((d, i) => 
  (i === 0 && d.DriverAhead !== "") || 
  (i > 0 && d.DriverAhead !== "" && d.DriverAhead !== tidy[i - 1].DriverAhead)
);
display(Plot.plot({
  marks: [Plot.dot(changes, {x: "x", y: "y"})]
}))
```
